智能制造系统中立体神经视觉的校准摘要:提出一种利用神经网络校准立体视觉系统的方法。
该方法充分利用神经网络的学习、记忆功能,采用样本进行训练后,神经网络能学习到立体视觉系统中的非线性关系和摄像机的内外方位元素,并且保存起来。
该方法克服了传统校准方法计算复杂、计算量大的缺点。
通过实际应用,获得了很好的效果。
关键词:bp神经网络;立体视觉;校准中图分类号:tp205文献标识码:a文章编号:0529-6579(2002)01-0025-04摄像机校准是利用立体视觉获取三维信息过程的重要环节之一,校准精度直接影响系统获取三维信息的准确性。
传统的校准方法是利用空间已知的三维点及其在二维图像上的成像,通过投影关系建立必须满足的方程,计算出摄像机的内外方位元素,达到校准的目的。
tsai[1]所提出的是这类方法的典型代表,至今还是一种很有效的方法。
随后,在此基础上发展出其它方法。
liu[2]等利用空间任意点与其成像来校准摄像机,wang[3]等提出了利用灭线(vanishingline)来计算摄像机的内外方位元素,近年来,还有利用空间任意直线与其成像进行校准。
这类方法最大的优点是能给出摄像机内外方位元素的具体值,其缺点是计算过程很复杂,计算量很大,如果需要考虑校准过程中的误差时,还必须设计一个复杂的迭代过程,因而,在有些情况下应用很不方便。
本文提出了一种利用神经网络校准立体视觉系统的方法,在该方法中,充分利用神经网络的学习和记忆功能,采用空间已知点与其成像构造训练样本,通过训练后,神经网络能学习到立体视觉系统中的非线性关系和摄像机的内外方位元素,并且保存起来,以便需要时使用。
该方法特别适用于立体神经视觉系统的校准,使用方便。
本文通过实际应用,验证了该方法的正确性和可靠性。
1立体视觉校准问题立体视觉主要是用来从二维的立体像对中获取空间物体的三维信息,为了达到这一目的,首先必须确定立体视觉系统中像平面坐标与空间坐标系之间的关系,确定摄像机的空间位置,获得其内方位元素和外方位元素。
立体视觉中,摄像机像平面与空间物体的关系如图1所示。
传统的校准方法是利用立体视觉必需满足的共线方程,通过已知的空间点与其成像求解出摄像机的内外方位元素。
该共线方程为式中,x,y,z为物空间点的三维坐标;xs,ys,zs为摄像机位置的空间坐标;ai,bi,ci(i=1,2,3)为摄像机的外方位元素;f为摄像机焦距;x,y为所对应点的图像坐标。
从式(1)可以看出,要求出摄像机的内外方位元素,必须利用多个点代入,求解非线性方程组才能得出结果,如果要考虑误差时,还必须设计一个复杂的反复迭代过程。
2用于校准的神经网络2.1校准神经网络的构成本文充分利用神经网络的学习和记忆功能,采用象坐标以及与其对应的空间物体坐标已知的一组点作为训练样本,对校准用的神经网络进行训练,使其学习到立体神经系统的非线性关系和摄像机的内外方位元素,并把它们保存在神经元上,以便需要时使用。
图2所示为本文所构造的用于校准的神经网络。
这是一个4层bp神经网络,第1层为输入层,有4个神经元,分别对应左图像点的坐标(xl,yl)和右图像上对应点的坐标(xr,yr);第4层为输出层,有3个神经元,分别对应相应的空间点的坐标(x,y,z);中间有2个隐含层,每个隐含层有50个神经元,用来储存所学到的系统二维到三维的非线性关系,以及摄像机的内外方位元素。
2.2学习算法的检验在神经网络中,学习算法是很重要的。
本文采用的算法如下:wqij(k+1)=wqij(k)+αdqij(k+1)(2)dqij(k+1)=σpp=1δqpi(k+1)x(q-1)pj(k+1)(3)δqpi(k+1)=σn(q+1)k=1δ(q+1)pk(k+1)w(q+1)ki(k)μxqpi(k+1)(1-xqpi(k+1))(4)式中,q=1,2,3;i=1,2,…,nq;j=1,2,…,n(q-1)为了检验本文所采用的学习算法的正确性和可靠性,这里对一个非线性系统进行模拟。
对这个非线性系统,并不知道它的数学模型、结构以及其它特性,这类系统通常被称为“黑盒子”。
我们所知道的只是它的输入x1(s)=1x2(s)=1.0s(5)和它的理想输出yd(s)=1-e0.05s(6)对于该非线性系统,建立一个4层的bp神经网络。
输入层有2个神经元,输出层有1个神经元,每个隐含层含有40个神经元。
取s=1,2,…,100,从方程(2)和(3)中获得100组学习样本。
其模拟结果如图3所示,其中yd为非线性系统的理想的输出,y1为神经网络学习后的输出。
从图3中可以看出,实际输出y1与理想输出yd非常的接近,这说明本文所用的学习算法是正确可靠的。
3立体神经视觉的校准3.1构造训练样本这里采用一个涡轮叶片来构造神经网络的训练样本,图4为该涡轮叶片的立体像对,选择立体像对左右图像的对应点,并且测量出其对应的空间三维坐标,构造训练样本如表1所示。
这个训练样本是由24个点的数据组成的,其中每一个点包括立体像对左右图像上该点的像坐标和实际测量出的该点的空间坐标。
为了与后面计算结果进行比较,这里利用这些实际测量出的空间点构造出该曲面如图5所示。
3.2校准结果利用上述所构造的样本,对图2所示的校准神经网络进行训练,通过训练,该神经网络能学习到视觉系统中二维像平面坐标系与三维空间坐标系之间的非线性关系,并且学习到摄像机的内外方位元素,并且把它们保存起来。
获得了这些非线性关系和摄像机的内外方位元素,这就完成了对立体视觉系统的校准。
为了对校准结果进行检验,这里对涡轮叶片表面进行三维重建。
读取涡轮叶片立体像对左右图像上相对应的点,利用图2所示的神经网络得出该点的三维坐标。
计算过程所用到的二维到三维的非线性关系以及摄像机的内外方位元素是由上述校准过程获得的。
通过这个三维重建过程,可以获得足够多的涡轮叶片表面的三维点。
如果利用多个神经网络组合,还可以实现一个并行计算过程。
图5b是重建后的涡轮叶片表面。
图5b和计算结果表明,重建后的涡轮叶片表面与实际测量的表面(图5a所示)相当接近,这也就说明了本文所提出的利用神经网络对立体视觉系统的校准方法是正确可靠的,并且校准精度令人满意,如果增加训练样本中点的数量,校准精度还会提高。
4结论本文充分利用神经网络的学习和记忆功能,提出了一种利用神经网络校准立体视觉系统的方法,利用样本数据对神经网络进行训练,使其学习到立体视觉系统中二维图像平面坐标系与空间坐标系之间的非线性关系以及摄像机的内外方位元素,从而达到对立体视觉系统校准的目的。
为了检验所提出的校准方法的正确性,本文利用一个涡轮叶片表面的真实数据构造训练样本,系统校后,对该表面进行了三维重建,重建后的结果与实际表面相对比,得出了非常令人满意的结果。
